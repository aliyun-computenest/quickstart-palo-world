ROSTemplateFormatVersion: '2015-09-01'
Description:
  en: Deploy palworld game server
  zh-cn: 部署幻兽帕鲁游戏服务
Parameters:
  Checkbox:
    Type: String
    Label:
      en: Backup Instructions
      zh-cn: 备份说明
    AssociationProperty: AlertCheckbox
    AssociationPropertyMetadata:
      Description: 使用本服务会重置ECS系统盘，使用前请确保无重要数据或已完成数据备份，以免丢失数据。<a href="https://computenest.console.aliyun.com/service/detail/cn-hangzhou/service-959ba5511d6c481fbb50/6?isInstance=true" target="_blank">备份游戏存档</a>
      ConfirmText: 我已备份完成(或无需备份)
      Alert: true
      Type: warning
      MustChecked: true
  OSType:
    Type: String
    Label:
      en: Operation System Type
      zh-cn: 操作系统类型
    Description:
      en: Operation System Type, <font color='red'>If do not want to change OS type, check the current OS type of ECS instance. Only region in China mainland supports changing OS type, please specify current OS type of ECS instance if it is in other regions</font>
      zh-cn: 操作系统类型,<font color='red'>如不希望更换操作系统请先确认已有ECS的操作系统类型。只有中国内地地域才支持更换操作系统类型，其他地域请指定为当前ECS实例的操作系统类型</font>
    AllowedValues:
      - linux
      - windows
  InstanceId:
    Type: String
    Label:
      en: Select Running ECS Instance
      zh-cn: 选择运行中的ECS实例
    AssociationProperty: ALIYUN::ECS::Instance::InstanceId
    AssociationPropertyMetadata:
      OnlyShowSelector: true
      RegionId: ${RegionId}
      Status: Running
      DisabledStatus: true
  CreateImage:
    Type: String
    Label:
      en: Whether Create Backup
      zh-cn: 是否创建备份
    Description:
      zh-cn: 使用本服务将会重置ECS实例的系统盘，使用前请确保无重要数据或已经完成数据备份，避免数据丢失。选择“创建”将会自动为您备份镜像，会产生0.12元/GB/月的相关费用
      en: Using this service will reset the system disk of the ECS instance. Before using it, please ensure that there is no important data or that you have already completed a data backup to avoid data loss. Choosing "Create" will automatically back up the image for you, which will incur a related cost.
    Default: 'NoCreate'
    AllowedValues:
      - 'Create'
      - 'NoCreate'
    AssociationPropertyMetadata:
      ValueLabelMapping:
        'NoCreate': 不创建
        'Create': 创建
  InstancePassword:
    Type: String
    Label:
      en: ECS Instance Password
      zh-cn: 实例密码
    Description:
      en: Server login password, Length 8-30, must contain three(Capital letters,
        lowercase letters, numbers, ()`~!@#$%^&*_-+=|{}[]:;'<>,.?/ Special symbol
        in)
      zh-cn: 服务器登录密码,长度8-30，必须包含三项（大写字母、小写字母、数字、 ()`~!@#$%^&*_-+=|{}[]:;'<>,.?/ 中的特殊符号）
    AssociationProperty: ALIYUN::ECS::Instance::Password
    AssociationPropertyMetadata:
      OSType: ${OSType}
    NoEcho: true
  # 环境变量设置
  ServerName:
    Type: String
    Label:
      en: Server Name
      zh-cn: 服务器名称
    Description:
      en: ServerName
      zh-cn: ServerName
    Default: "Default Palworld Server"
    AllowedPattern: '^[A-Za-z0-9\ ]*$'
    ConstraintDescription:
      zh-cn: '只允许大写字母、小写字母、数字和空格，不允许包含特殊符号'
      en: >-
        Only uppercase letters, lowercase letters, numbers, and Spaces are allowed, and special symbols are not allowed
  ServerDescription:
    Type: String
    Label:
      en: Server Description
      zh-cn: 服务器描述
    Description:
      en: ServerDescription
      zh-cn: ServerDescription
    Default: ""
    AllowedPattern: "^[A-Za-z0-9\ ]*$"
    ConstraintDescription:
      zh-cn: '只允许大写字母、小写字母、数字和空格，不允许包含特殊符号'
      en: >-
        Only uppercase letters, lowercase letters, numbers, and Spaces are allowed, and special symbols are not allowed
  ServerPlayerMaxNum:
    Type: Number
    Label:
      en: Server Player Max Number
      zh-cn: 服务器最多可加入人数
    Description:
      en: ServerPlayerMaxNum
      zh-cn: ServerPlayerMaxNum
    Default: 32
    AssociationPropertyMetadata:
      StringMode: true
      Step: 1
  Difficulty:
    Type: String
    Label:
      en: Difficulty
      zh-cn: 困难程度
    Description:
      en: Difficulty
      zh-cn: Difficulty，游戏的具体难易程度由其他参数组合而来，与此参数的关系不大，选择None即可
    Default: "None"
    AllowedPattern: "^[A-Za-z0-9\ ]+$"
    AllowedValues:
      - None
      - Easy
      - Normal
      - Hard
  DayTimeSpeedRate:
    Type: Number
    Label:
      en: Day time speed
      zh-cn: 白天流逝速度
    Description:
      en: DayTimeSpeedRate
      zh-cn: DayTimeSpeedRate
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MaxValue: 5.0
    MinValue: 0.1
  NightTimeSpeedRate:
    Type: Number
    Label:
      en: Night time speed
      zh-cn: 夜间流逝速度
    Default: "1.000000"
    Description:
      en: NightTimeSpeedRate
      zh-cn: NightTimeSpeedRate
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MaxValue: 5.0
    MinValue: 0.1
  ExpRate:
    Type: Number
    Label:
      en: EXP rate
      zh-cn: 经验值倍率
    Default: "1.000000"
    Description:
      en: ExpRate
      zh-cn: ExpRate
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MaxValue: 20.0
    MinValue: 0.1
  ItemWeightRate:
    Type: Number
    Label:
      en: ItemWeightRate
      zh-cn: 物品重量倍率
    Default: "0"
    Description:
      en: ItemWeightRate
      zh-cn: 物品重量倍率
    AssociationPropertyMetadata:
      StringMode: true
      Step: 1
      UseSlider: true
    MaxValue: 10
    MinValue: 0
  PalCaptureRate:
    Type: Number
    Label:
      en: Pal capture rate
      zh-cn: 帕鲁抓捕机率
    Description:
      en: PalCaptureRate
      zh-cn: PalCaptureRate，此参数的灵敏度较高，容易影响游戏难易程度，通常困难模式下取值为0.8, 简单模式下为2
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MaxValue: 2.0
    MinValue: 0.5
  PalSpawnNumRate:
    Type: Number
    Label:
      en: Pal appearance rate
      zh-cn: 帕鲁的出现率
    Description:
      en: PalSpawnNumRate
      zh-cn: PalSpawnNumRate
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.5
    MaxValue: 3.0
  PalDamageRateAttack:
    Type: Number
    Label:
      en: Damage from pals multipiler
      zh-cn: 帕鲁造成的伤害倍率
    Description:
      en: PalDamageRateAttack
      zh-cn: PalDamageRateAttack
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.1
    MaxValue: 5
  PalDamageRateDefense:
    Type: Number
    Label:
      en: Damage to pals multipiler
      zh-cn: 帕鲁受到的伤害倍率
    Description:
      en: PalDamageRateDefense
      zh-cn: PalDamageRateDefense
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.1
    MaxValue: 5
  PlayerDamageRateAttack:
    Type: Number
    Label:
      en: Damage from player multipiler
      zh-cn: 玩家造成的伤害倍率
    Description:
      en: PlayerDamageRateAttack
      zh-cn: PlayerDamageRateAttack
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.1
    MaxValue: 5
  PlayerDamageRateDefense:
    Type: Number
    Label:
      en: Damage to player multipiler
      zh-cn: 玩家受到的伤害倍率
    Description:
      en: PlayerDamageRateDefense
      zh-cn: PlayerDamageRateDefense
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.1
    MaxValue: 5
  PlayerStomachDecreaceRate:
    Type: Number
    Label:
      en: Player hunger depletion rate
      zh-cn: 玩家饱足感的下降速率
    Description:
      en: PlayerStomachDecreaceRate
      zh-cn: PlayerStomachDecreaceRate
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.1
    MaxValue: 5
  PlayerStaminaDecreaceRate:
    Type: Number
    Label:
      en: Player stamina reduction rate
      zh-cn: 玩家耐力的下降速率
    Description:
      en: PlayerStaminaDecreaceRate
      zh-cn: PlayerStaminaDecreaceRate
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.1
    MaxValue: 5
  PlayerAutoHPRegeneRate:
    Type: Number
    Label:
      en: Player auto HP regeneration rate
      zh-cn: 玩家生命值自然恢复速率
    Description:
      en: PlayerAutoHPRegeneRate
      zh-cn: PlayerAutoHPRegeneRate
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.1
    MaxValue: 5
  PlayerAutoHpRegeneRateInSleep:
    Type: Number
    Label:
      en: Player sleep HP regeneration rate
      zh-cn: 玩家睡眠时生命值恢复速率
    Description:
      en: PlayerAutoHpRegeneRateInSleep
      zh-cn: PlayerAutoHpRegeneRateInSleep
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.1
    MaxValue: 5
  PalStomachDecreaceRate:
    Type: Number
    Label:
      en: Pal hunger depletion rate
      zh-cn: 帕鲁饱足感的下降速率
    Description:
      en: PalStomachDecreaceRate
      zh-cn: PalStomachDecreaceRate
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.1
    MaxValue: 5
  PalStaminaDecreaceRate:
    Type: Number
    Label:
      en: Pal stamina reduction rate
      zh-cn: 帕鲁耐力的下降速率
    Description:
      en: PalStaminaDecreaceRate
      zh-cn: PalStaminaDecreaceRate
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.1
    MaxValue: 5
  PalAutoHPRegeneRate:
    Type: Number
    Label:
      en: Pal auto HP regeneration rate
      zh-cn: 帕鲁生命值自然恢复倍率
    Description:
      en: PalAutoHPRegeneRate
      zh-cn: PalAutoHPRegeneRate
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.1
    MaxValue: 5
  PalAutoHpRegeneRateInSleep:
    Type: Number
    Label:
      en: Pal sleep health regeneration rate (in Palbox)
      zh-cn: 帕鲁睡眠时生命值恢复倍率
    Description:
      en: PalAutoHpRegeneRateInSleep
      zh-cn: PalAutoHpRegeneRateInSleep
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.1
    MaxValue: 5
  BuildObjectDamageRate:
    Type: Number
    Label:
      en: Damage to structure multipiler
      zh-cn: 对建筑物的伤害倍率
    Description:
      en: BuildObjectDamageRate
      zh-cn: BuildObjectDamageRate
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.5
    MaxValue: 3
  BuildObjectDeteriorationDamageRate:
    Type: Number
    Label:
      en: Structure determination rate
      zh-cn: 建筑物的劣化速率
    Description:
      en: BuildObjectDeteriorationDamageRate
      zh-cn: BuildObjectDeteriorationDamageRate
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0
    MaxValue: 10
  CollectionDropRate:
    Type: Number
    Label:
      en: Getherable items multipiler
      zh-cn: 资源采集量倍率
    Description:
      en: CollectionDropRate
      zh-cn: CollectionDropRate
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.5
    MaxValue: 3
  CollectionObjectHpRate:
    Type: Number
    Label:
      en: Getherable objects HP multipiler
      zh-cn: 采集资源的生命值倍率
    Description:
      en: CollectionObjectHpRate
      zh-cn: CollectionObjectHpRate
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.5
    MaxValue: 3
  CollectionObjectRespawnSpeedRate:
    Type: Number
    Label:
      en: Getherable objects respawn interval
      zh-cn: 采集资源的刷新间隔
    Description:
      en: CollectionObjectRespawnSpeedRate
      zh-cn: CollectionObjectRespawnSpeedRate
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.5
    MaxValue: 3
  EnemyDropItemRate:
    Type: Number
    Label:
      en: Dropped Items Multipiler
      zh-cn: 敌人掉落物品倍率
    Description:
      en: EnemyDropItemRate
      zh-cn: EnemyDropItemRate
    Default: "1.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0.5
    MaxValue: 3
  DeathPenalty:
    Type: String
    Label:
      en: "Death penalty None : No lost, Item : Lost item without equipment, ItemAndEquipment : Lost item and equipment, All : Lost All item, equipment, pal(in inventory)"
      zh-cn: "死亡惩罚"
    Description:
      en: DeathPenalty
      zh-cn: DeathPenalty
    Default: "None"
    AllowedValues:
      - None
      - Item
      - ItemAndEquipment
      - All
    AssociationPropertyMetadata:
      ValueLabelMapping:
        None: 死亡不掉落
        Item: 死亡掉物品
        ItemAndEquipment: 死亡掉物品和装备
        All: 全部掉
  bEnablePlayerToPlayerDamage:
    Type: String
    Label:
      en: Whether to allow player causes damage to the player
      zh-cn: 是否允许玩家对玩家造成伤害
    Description:
      en: bEnablePlayerToPlayerDamage
      zh-cn: bEnablePlayerToPlayerDamage
    Default: "False"
    AllowedValues:
      - "False"
      - "True"
    AssociationPropertyMetadata:
      ValueLabelMapping:
        "True": 开启
        "False": 关闭
  bEnableFriendlyFire:
    Type: String
    Label:
      en: Whether to allow players to do damage to their own Pal and fellow Guild players
      zh-cn: 是否允许玩家对自己帕鲁和同公会玩家的伤害
    Description:
      en: bEnableFriendlyFire
      zh-cn: bEnableFriendlyFire
    Default: "False"
    AllowedValues:
      - "False"
      - "True"
    AssociationPropertyMetadata:
      ValueLabelMapping:
        "True": 开启
        "False": 关闭
  bEnableInvaderEnemy:
    Type: String
    Label:
      en: Whether to attack the enemy
      zh-cn: 是否允许袭击敌人
    Description:
      en: bEnableInvaderEnemy
      zh-cn: bEnableInvaderEnemy
    Default: "True"
    AllowedValues:
      - "False"
      - "True"
    AssociationPropertyMetadata:
      ValueLabelMapping:
        "True": 开启
        "False": 关闭
  bActiveUNKO:
    Type: String
    Label:
      en: Whether to active the UNKO event
      zh-cn: 是否开启神秘的UNKO事件
    Description:
      en: bActiveUNKO
      zh-cn: bActiveUNKO
    Default: "False"
    AllowedValues:
      - "False"
      - "True"
    AssociationPropertyMetadata:
      ValueLabelMapping:
        "True": 开启
        "False": 关闭
  bEnableAimAssistPad:
    Type: String
    Label:
      en: Whether to enable handle aiming assist
      zh-cn: 是否启用手柄辅助瞄准
    Description:
      en: bEnableAimAssistPad
      zh-cn: bEnableAimAssistPad
    Default: "True"
    AllowedValues:
      - "False"
      - "True"
    AssociationPropertyMetadata:
      ValueLabelMapping:
        "True": 开启
        "False": 关闭
  bEnableAimAssistKeyboard:
    Type: String
    Label:
      en: Whether keyboard and mouse assisted aiming is enabled
      zh-cn: 是否启用键鼠辅助瞄准
    Description:
      en: bEnableAimAssistKeyboard
      zh-cn: bEnableAimAssistKeyboard
    Default: "False"
    AllowedValues:
      - "False"
      - "True"
    AssociationPropertyMetadata:
      ValueLabelMapping:
        "True": 开启
        "False": 关闭
  DropItemMaxNum:
    Type: Number
    Label:
      en: The maximum amount of dropped objects in the world
      zh-cn: 世界内的掉落物上限
    Description:
      en: DropItemMaxNum
      zh-cn: DropItemMaxNum
    Default: "3000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 1
      UseSlider: true
  DropItemMaxNum_UNKO:
    Type: Number
    Label:
      en: The maximum amount of UNKO dropped objects in the world
      zh-cn: 神秘UNKO掉落物上限
    Default: "100"
    Description:
      en: DropItemMaxNum_UNKO
      zh-cn: DropItemMaxNum_UNKO
    AssociationPropertyMetadata:
      StringMode: true
      Step: 1
      UseSlider: true
  BaseCampMaxNum:
    Type: Number
    Label:
      en: Base maximum
      zh-cn: 基地最大数量
    Description:
      en: BaseCampMaxNum
      zh-cn: BaseCampMaxNum
    Default: "128"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 1
      UseSlider: true
  BaseCampWorkerMaxNum:
    Type: Number
    Label:
      en: Maximum number of palu working within the base
      zh-cn: 基地内工作帕鲁的最大数量
    Description:
      en: BaseCampWorkerMaxNum
      zh-cn: BaseCampWorkerMaxNum
    Default: 15
    AssociationPropertyMetadata:
      StringMode: true
      Step: 1
      UseSlider: true
  BaseCampMaxNumInGuild:
    Type: Number
    Label:
      en: Maximum number of base camp per guild
      zh-cn: 各公会的最大据点数
    Description:
      en: BaseCampMaxNumInGuild
      zh-cn: BaseCampMaxNumInGuild
    Default: 4
    MaxValue: 10
    AssociationPropertyMetadata:
      StringMode: true
      Step: 1
      UseSlider: true
  SupplyDropSpan:
    Type: Number
    Label:
      en: Meteorite and supply airdrop intervals
      zh-cn: 陨石&补给物资的空投间隔
    Description:
      en: SupplyDropSpan
      zh-cn: SupplyDropSpan
    Default: 180
    MaxValue: 600
    AssociationPropertyMetadata:
      StringMode: true
      Step: 1
      UseSlider: true
  DropItemAliveMaxHours:
    Type: Number
    Label:
      en: Retention time of dropped items
      zh-cn: 掉落物品的保留时间
    Description:
      en: DropItemAliveMaxHours
      zh-cn: DropItemAliveMaxHours, 建议该值不要设置的过大，避免掉落物太多造成卡顿
    Default: "1"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 1
      UseSlider: true
  bAutoResetGuildNoOnlinePlayers:
    Type: String
    Label:
      en: Whether to automatically help the player quit the guild
      zh-cn: 是否自动帮玩家退出公会
    Description:
      en: bAutoResetGuildNoOnlinePlayers
      zh-cn: bAutoResetGuildNoOnlinePlayers
    Default: "False"
    AllowedValues:
      - "False"
      - "True"
    AssociationPropertyMetadata:
      ValueLabelMapping:
        "True": 开启
        "False": 关闭
  AutoResetGuildTimeNoOnlinePlayers:
    Type: Number
    Label:
      en: Time(h) to help the player exit the guild
      zh-cn: 自动帮玩家退出公会的时间
    Description:
      en: AutoResetGuildTimeNoOnlinePlayers
      zh-cn: AutoResetGuildTimeNoOnlinePlayers
    Default: "72.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0
    MaxValue: 240
  bIsMultiplay:
    Type: String
    Label:
      en: Whether Multiplayer game
      zh-cn: 是否多人游戏
    Description:
      en: bIsMultiplay
      zh-cn: bIsMultiplay
    Default: "False"
    AllowedValues:
      - "False"
      - "True"
    AssociationPropertyMetadata:
      ValueLabelMapping:
        "True": 开启
        "False": 关闭
  bIsPvP:
    Type: String
    Label:
      en: Whether PvP model
      zh-cn: 是否PvP模式
    Description:
      en: bIsPvP
      zh-cn: bIsPvP
    Default: "False"
    AllowedValues:
      - "False"
      - "True"
    AssociationPropertyMetadata:
      ValueLabelMapping:
        "True": 开启
        "False": 关闭
  bCanPickupOtherGuildDeathPenaltyDrop:
    Type: String
    Label:
      en: Whether to pick up death drops from other guilds
      zh-cn: 是否捡取其他公会的死亡掉落物
    Description:
      en: bCanPickupOtherGuildDeathPenaltyDrop
      zh-cn: bCanPickupOtherGuildDeathPenaltyDrop
    Default: "False"
    AllowedValues:
      - "False"
      - "True"
    AssociationPropertyMetadata:
      ValueLabelMapping:
        "True": 开启
        "False": 关闭
  bEnableNonLoginPenalty:
    Type: String
    Label:
      en: Whether to enable non-login penalties
      zh-cn: 是否启用非登录惩罚
    Description:
      en: bEnableNonLoginPenalty
      zh-cn: bEnableNonLoginPenalty
    Default: "True"
    AllowedValues:
      - "False"
      - "True"
    AssociationPropertyMetadata:
      ValueLabelMapping:
        "True": 开启
        "False": 关闭
  bEnableFastTravel:
    Type: String
    Label:
      en: Whether to enable express travel
      zh-cn: 是否开启快速旅行
    Description:
      en: bEnableFastTravel
      zh-cn: bEnableFastTravel
    Default: "True"
    AllowedValues:
      - "False"
      - "True"
    AssociationPropertyMetadata:
      ValueLabelMapping:
        "True": 开启
        "False": 关闭
  bIsStartLocationSelectByMap:
    Type: String
    Label:
      en: Whether to select the starting location based on the map
      zh-cn: 是否根据地图选择起始位置
    Description:
      en: bIsStartLocationSelectByMap
      zh-cn: bIsStartLocationSelectByMap，若为关闭,死亡后依旧可以选择其他出生点
    Default: "True"
    AllowedValues:
      - "False"
      - "True"
    AssociationPropertyMetadata:
      ValueLabelMapping:
        "True": 开启
        "False": 关闭
  bExistPlayerAfterLogout:
    Type: String
    Label:
      en: Whether the player logs out to stay in place
      zh-cn: 玩家登出是否留在原地
    Description:
      en: bExistPlayerAfterLogout
      zh-cn: bExistPlayerAfterLogout
    Default: "False"
    AllowedValues:
      - "False"
      - "True"
    AssociationPropertyMetadata:
      ValueLabelMapping:
        "True": 开启
        "False": 关闭
  bEnableDefenseOtherGuildPlayer:
    Type: String
    Label:
      en: Whether to take damage from other guilds
      zh-cn: 是否受到其他公会伤害
    Description:
      en: bEnableDefenseOtherGuildPlayer
      zh-cn: bEnableDefenseOtherGuildPlayer
    Default: "False"
    AllowedValues:
      - "False"
      - "True"
    AssociationPropertyMetadata:
      ValueLabelMapping:
        "True": 开启
        "False": 关闭
  GuildPlayerMaxNum:
    Type: Number
    Label:
      en: Max player of Guild
      zh-cn: 公会最大玩家数
    Description:
      en: GuildPlayerMaxNum
      zh-cn: GuildPlayerMaxNum
    Default: 20
  CoopPlayerMaxNum:
    Type: Number
    Label:
      en: Max player of coop
      zh-cn: 合作的最大玩家数
    Description:
      en: CoopPlayerMaxNum
      zh-cn: CoopPlayerMaxNum
    Default: 4
  PalEggDefaultHatchingTime:
    Type: Number
    Label:
      en: Time(h) to incubate massive egg
      zh-cn: 巨大化蛋孵化所需时间（小时）
    Description:
      en: PalEggDefaultHatchingTime
      zh-cn: PalEggDefaultHatchingTime
    Default: "72.000000"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 0.000001
      UseSlider: true
    MinValue: 0
    MaxValue: 240
  WorkSpeedRate:
    Type: Number
    Label:
      en: WorkSpeedRate
      zh-cn: 工作效率
    Description:
      en: WorkSpeedRate
      zh-cn: WorkSpeedRate
    Default: "1"
    AssociationPropertyMetadata:
      StringMode: true
      Step: 1
      UseSlider: true
    MinValue: 0
    MaxValue: 240
  ServerPassword:
    Type: String
    Label:
      en: Server Password
      zh-cn: 服务器密码
    Description:
      en: ServerPassword
      zh-cn: ServerPassword
    AllowedPattern: '^[A-Za-z0-9\ ]*$'
    Default: ""
  AdminPassword:
    Type: String
    Label:
      en: Admin Password
      zh-cn: 服务器管理员密码
    Description:
      en: The admin password and RCON must be set at the same time to take effect.
      zh-cn: AdminPassword,管理员密码和启用RCON 同时设置才能生效
    AllowedPattern: '^[A-Za-z0-9\ ]*$'
    Default: ""
  RCONEnabled:
    Type: String
    Label:
      en: Enable RCON
      zh-cn: 启用RCON
    AssociationPropertyMetadata:
      ValueLabelMapping:
        "True": 开启
        "False": 关闭
    Description:
      en: The admin password and RCON must be set at the same time to take effect.
      zh-cn: 管理员密码和启用RCON 同时设置才能生效
    AllowedValues:
      - "False"
      - "True"
    Default: "False"
Conditions:
  IsCreateImage:
    Fn::Equals:
      - Ref: CreateImage
      - Create
  LinuxOSType:
    Fn::Equals:
      - Ref: OSType
      - linux
  WindowsOSType:
    Fn::Equals:
      - Ref: OSType
      - windows
Resources:
  InstanceDataSource:
    Type: DATASOURCE::ECS::Instances
    Properties:
      InstanceIds:
        - Ref: InstanceId
  EcsSecurityGroupIngress8211:
    Type: ALIYUN::ECS::SecurityGroupIngress
    Properties:
      SecurityGroupId:
        Fn::Select:
          - 0
          - Fn::Jq:
              - First
              - .[].SecurityGroupIds
              - 'Fn::GetAtt':
                  - InstanceDataSource
                  - Instances
      Priority: 1
      SourceCidrIp: 0.0.0.0/0
      IpProtocol: udp
      PortRange: '8211/8211'
  EcsSecurityGroupIngress22:
    Type: ALIYUN::ECS::SecurityGroupIngress
    Properties:
      SecurityGroupId:
        Fn::Select:
          - 0
          - Fn::Jq:
              - First
              - .[].SecurityGroupIds
              - 'Fn::GetAtt':
                  - InstanceDataSource
                  - Instances
      Priority: 1
      SourceCidrIp: 0.0.0.0/0
      IpProtocol: tcp
      PortRange: '22/22'
  EcsSecurityGroupIngress3389:
    Type: ALIYUN::ECS::SecurityGroupIngress
    Properties:
      SecurityGroupId:
        Fn::Select:
          - 0
          - Fn::Jq:
              - First
              - .[].SecurityGroupIds
              - 'Fn::GetAtt':
                  - InstanceDataSource
                  - Instances
      Priority: 1
      SourceCidrIp: 0.0.0.0/0
      IpProtocol: tcp
      PortRange: '3389/3389'
  CustomImage:
    Type: ALIYUN::ECS::CustomImage
    Condition: IsCreateImage
    Properties:
      InstanceId:
        Ref: InstanceId
  Template:
    Type: ALIYUN::OOS::Template
    DependsOn:
      - CustomImage
    Properties:
      TemplateName:
        Fn::Join:
          - '-'
          - - template
            - Ref: ALIYUN::StackName
      Content: '{"FormatVersion":"OOS-2019-06-01","Description":{"en":"Upgrade Server Version","zh-cn":"升级服务端版本","name-en":"Upgrade Server Version","name-zh-cn":"升级服务端版本"},"Parameters":{"regionId":{"Type":"String","Label":{"en":"RegionId","zh-cn":"地域ID"},"AssociationProperty":"RegionId","Default":"{{ ACS::RegionId }}"},"instanceId":{"Type":"String"},"imageId":{"Type":"String"},"password":{"Type":"String"}},"Tasks":[{"Name":"getInstance","Description":{"en":"Views the ECS instances","zh-cn":"获取ECS实例"},"Action":"ACS::SelectTargets","Properties":{"ResourceType":"ALIYUN::ECS::Instance","RegionId":"{{ regionId }}","Filters":[{"Type":"ResourceIds","ResourceIds":["{{ instanceId }}"],"RegionId":"{{ regionId }}"}]},"Outputs":{"instanceId":{"Type":"String","ValueSelector":"Instances.Instance[].InstanceId"},"OSType":{"Type":"String","ValueSelector":"Instances.Instance[].OSType"}}},{"Name":"replaceSystemDisk","Action":"ACS::ECS::ReplaceSystemDisk","Description":{"en":"Replaces the system disk of ECS instances","zh-cn":"更换系统盘"},"Properties":{"regionId":"{{ regionId }}","instanceId":"{{ getInstance.instanceId }}","imageId":"{{ imageId }}","password":"{{ password }}"}},{"Name":"sleep","Action":"ACS::Sleep","Properties":{"Duration":"PT1M"}}],"Metadata":{"ALIYUN::OOS::Interface":{"ParameterGroups":[{"Parameters":["regionId","instanceId","imageId","password"],"Label":{"default":{"zh-cn":"选择实例","en":"Select Instances"}}}]}}}'
      # m-2zeiuab6ahthsrnxktfx
  ReplaceLinuxSystemDisk:
    Type: ALIYUN::OOS::Execution
    Condition: LinuxOSType
    DependsOn:
      - Template
    Properties:
      SafetyCheck: Skip
      TemplateName:
        Fn::Join:
          - '-'
          - - template
            - Ref: ALIYUN::StackName
      Parameters:
        regionId:
          Ref: ALIYUN::Region
        instanceId:
          Ref: InstanceId
        imageId: linux
        password:
          Ref: InstancePassword
  ReplaceWindowsSystemDisk:
    Type: ALIYUN::OOS::Execution
    Condition: WindowsOSType
    DependsOn:
      - Template
    Properties:
      SafetyCheck: Skip
      TemplateName:
        Fn::Join:
          - '-'
          - - template
            - Ref: ALIYUN::StackName
      Parameters:
        regionId:
          Ref: ALIYUN::Region
        instanceId:
          Ref: InstanceId
        imageId: windows
        password:
          Ref: InstancePassword
  SleepBeforeRunCommand:
    Type: ALIYUN::ROS::Sleep
    DependsOn:
      - ReplaceLinuxSystemDisk
      - ReplaceWindowsSystemDisk
    Properties:
      CreateDuration: 60
  LinuxInstanceRunCommand:
    Type: ALIYUN::ECS::RunCommand
    Condition: LinuxOSType
    DependsOn:
      - ReplaceLinuxSystemDisk
      - SleepBeforeRunCommand
    Properties:
      Timeout: 7200
      Type: RunShellScript
      Username: ecs-assist-user
      Sync: true
      InstanceIds:
        - Ref: InstanceId
      CommandContent:
        Fn::Sub: |
          #!/bin/bash
          sudo systemctl stop pal-server
          /usr/games/steamcmd +login anonymous +app_update 2394010 validate +quit
          # 修改复制文件到目标目录
          sudo -u ecs-assist-user sed -i 's/-useperfthreads -NoAsyncLoadingThread -UseMultithreadForDS//' /home/ecs-assist-user/.steam/SteamApps/common/PalServer/run.sh
          cp /home/ecs-assist-user/.steam/SteamApps/common/PalServer/DefaultPalWorldSettings.ini /home/ecs-assist-user/.steam/SteamApps/common/PalServer/Pal/Saved/Config/LinuxServer/PalWorldSettings.ini
          cd /home/ecs-assist-user/.steam/SteamApps/common/PalServer/Pal/Saved/Config/LinuxServer
          sed -i 's/Difficulty=[^,)]*/Difficulty=${Difficulty}/' PalWorldSettings.ini
          sed -i 's/DayTimeSpeedRate=[^,)]*/DayTimeSpeedRate=${DayTimeSpeedRate}/' PalWorldSettings.ini
          sed -i 's/NightTimeSpeedRate=[^,)]*/NightTimeSpeedRate=${NightTimeSpeedRate}/' PalWorldSettings.ini
          sed -i 's/ExpRate=[^,)]*/ExpRate=${ExpRate}/' PalWorldSettings.ini
          sed -i 's/PalCaptureRate=[^,)]*/PalCaptureRate=${PalCaptureRate}/' PalWorldSettings.ini
          sed -i 's/PalSpawnNumRate=[^,)]*/PalSpawnNumRate=${PalSpawnNumRate}/' PalWorldSettings.ini
          sed -i 's/PalDamageRateAttack=[^,)]*/PalDamageRateAttack=${PalDamageRateAttack}/' PalWorldSettings.ini
          sed -i 's/PalDamageRateDefense=[^,)]*/PalDamageRateDefense=${PalDamageRateDefense}/' PalWorldSettings.ini
          sed -i 's/PlayerDamageRateAttack=[^,)]*/PlayerDamageRateAttack=${PlayerDamageRateAttack}/' PalWorldSettings.ini
          sed -i 's/PlayerDamageRateDefense=[^,)]*/PlayerDamageRateDefense=${PlayerDamageRateDefense}/' PalWorldSettings.ini
          sed -i 's/PlayerStomachDecreaceRate=[^,)]*/PlayerStomachDecreaceRate=${PlayerStomachDecreaceRate}/' PalWorldSettings.ini
          sed -i 's/PlayerStaminaDecreaceRate=[^,)]*/PlayerStaminaDecreaceRate=${PlayerStaminaDecreaceRate}/' PalWorldSettings.ini
          sed -i 's/PlayerAutoHPRegeneRate=[^,)]*/PlayerAutoHPRegeneRate=${PlayerAutoHPRegeneRate}/' PalWorldSettings.ini
          sed -i 's/PlayerAutoHpRegeneRateInSleep=[^,)]*/PlayerAutoHpRegeneRateInSleep=${PlayerAutoHpRegeneRateInSleep}/' PalWorldSettings.ini
          sed -i 's/PalStomachDecreaceRate=[^,)]*/PalStomachDecreaceRate=${PalStomachDecreaceRate}/' PalWorldSettings.ini
          sed -i 's/PalStaminaDecreaceRate=[^,)]*/PalStaminaDecreaceRate=${PalStaminaDecreaceRate}/' PalWorldSettings.ini
          sed -i 's/PalAutoHPRegeneRate=[^,)]*/PalAutoHPRegeneRate=${PalAutoHPRegeneRate}/' PalWorldSettings.ini
          sed -i 's/PalAutoHpRegeneRateInSleep=[^,)]*/PalAutoHpRegeneRateInSleep=${PalAutoHpRegeneRateInSleep}/' PalWorldSettings.ini
          sed -i 's/BuildObjectDamageRate=[^,)]*/BuildObjectDamageRate=${BuildObjectDamageRate}/' PalWorldSettings.ini
          sed -i 's/BuildObjectDeteriorationDamageRate=[^,)]*/BuildObjectDeteriorationDamageRate=${BuildObjectDeteriorationDamageRate}/' PalWorldSettings.ini
          sed -i 's/CollectionDropRate=[^,)]*/CollectionDropRate=${CollectionDropRate}/' PalWorldSettings.ini
          sed -i 's/CollectionObjectHpRate=[^,)]*/CollectionObjectHpRate=${CollectionObjectHpRate}/' PalWorldSettings.ini
          sed -i 's/CollectionObjectRespawnSpeedRate=[^,)]*/CollectionObjectRespawnSpeedRate=${CollectionObjectRespawnSpeedRate}/' PalWorldSettings.ini
          sed -i 's/EnemyDropItemRate=[^,)]*/EnemyDropItemRate=${EnemyDropItemRate}/' PalWorldSettings.ini
          sed -i 's/DeathPenalty=[^,)]*/DeathPenalty=${DeathPenalty}/' PalWorldSettings.ini
          sed -i 's/GuildPlayerMaxNum=[^,)]*/GuildPlayerMaxNum=${GuildPlayerMaxNum}/' PalWorldSettings.ini
          sed -i 's/PalEggDefaultHatchingTime=[^,)]*/PalEggDefaultHatchingTime=${PalEggDefaultHatchingTime}/' PalWorldSettings.ini
          sed -i 's/ServerPlayerMaxNum=[^,)]*/ServerPlayerMaxNum=${ServerPlayerMaxNum}/' PalWorldSettings.ini
          sed -i 's/ServerName=[^,)]*/ServerName=\"${ServerName}\"/' PalWorldSettings.ini
          sed -i 's/ServerDescription=[^,)]*/ServerDescription=\"${ServerDescription}\"/' PalWorldSettings.ini
          sed -i 's/ServerPassword=[^,)]*/ServerPassword=\"${ServerPassword}\"/' PalWorldSettings.ini
          sed -i 's/AdminPassword=[^,)]*/AdminPassword=\"${AdminPassword}\"/' PalWorldSettings.ini
          sed -i 's/RCONEnabled=[^,)]*/RCONEnabled=${RCONEnabled}/' PalWorldSettings.ini
          sed -i 's/bEnablePlayerToPlayerDamage=[^,)]*/bEnablePlayerToPlayerDamage=${bEnablePlayerToPlayerDamage}/' PalWorldSettings.ini
          sed -i 's/bEnableFriendlyFire=[^,)]*/bEnableFriendlyFire=${bEnableFriendlyFire}/' PalWorldSettings.ini
          sed -i 's/bEnableInvaderEnemy=[^,)]*/bEnableInvaderEnemy=${bEnableInvaderEnemy}/' PalWorldSettings.ini
          sed -i 's/bActiveUNKO=[^,)]*/bActiveUNKO=${bActiveUNKO}/' PalWorldSettings.ini
          sed -i 's/bEnableAimAssistPad=[^,)]*/bEnableAimAssistPad=${bEnableAimAssistPad}/' PalWorldSettings.ini
          sed -i 's/bEnableAimAssistKeyboard=[^,)]*/bEnableAimAssistKeyboard=${bEnableAimAssistKeyboard}/' PalWorldSettings.ini
          sed -i 's/DropItemMaxNum=[^,)]*/DropItemMaxNum=${DropItemMaxNum}/' PalWorldSettings.ini
          sed -i 's/DropItemMaxNum_UNKO=[^,)]*/DropItemMaxNum_UNKO=${DropItemMaxNum_UNKO}/' PalWorldSettings.ini
          sed -i 's/BaseCampMaxNum=[^,)]*/BaseCampMaxNum=${BaseCampMaxNum}/' PalWorldSettings.ini
          sed -i 's/BaseCampWorkerMaxNum=[^,)]*/BaseCampWorkerMaxNum=${BaseCampWorkerMaxNum}/' PalWorldSettings.ini
          sed -i 's/BaseCampMaxNumInGuild=[^,)]*/BaseCampMaxNumInGuild=${BaseCampMaxNumInGuild}/' PalWorldSettings.ini
          sed -i 's/SupplyDropSpan=[^,)]*/SupplyDropSpan=${SupplyDropSpan}/' PalWorldSettings.ini
          sed -i 's/ItemWeightRate=[^,)]*/ItemWeightRate=${ItemWeightRate}/' PalWorldSettings.ini
          sed -i 's/DropItemAliveMaxHours=[^,)]*/DropItemAliveMaxHours=${DropItemAliveMaxHours}/' PalWorldSettings.ini
          sed -i 's/bAutoResetGuildNoOnlinePlayers=[^,)]*/bAutoResetGuildNoOnlinePlayers=${bAutoResetGuildNoOnlinePlayers}/' PalWorldSettings.ini
          sed -i 's/AutoResetGuildTimeNoOnlinePlayers=[^,)]*/AutoResetGuildTimeNoOnlinePlayers=${AutoResetGuildTimeNoOnlinePlayers}/' PalWorldSettings.ini
          sed -i 's/bIsMultiplay=[^,)]*/bIsMultiplay=${bIsMultiplay}/' PalWorldSettings.ini
          sed -i 's/bIsPvP=[^,)]*/bIsPvP=${bIsPvP}/' PalWorldSettings.ini
          sed -i 's/bCanPickupOtherGuildDeathPenaltyDrop=[^,)]*/bCanPickupOtherGuildDeathPenaltyDrop=${bCanPickupOtherGuildDeathPenaltyDrop}/' PalWorldSettings.ini
          sed -i 's/bEnableNonLoginPenalty=[^,)]*/bEnableNonLoginPenalty=${bEnableNonLoginPenalty}/' PalWorldSettings.ini
          sed -i 's/bEnableFastTravel=[^,)]*/bEnableFastTravel=${bEnableFastTravel}/' PalWorldSettings.ini
          sed -i 's/bIsStartLocationSelectByMap=[^,)]*/bIsStartLocationSelectByMap=${bIsStartLocationSelectByMap}/' PalWorldSettings.ini
          sed -i 's/bExistPlayerAfterLogout=[^,)]*/bExistPlayerAfterLogout=${bExistPlayerAfterLogout}/' PalWorldSettings.ini
          sed -i 's/bEnableDefenseOtherGuildPlayer=[^,)]*/bEnableDefenseOtherGuildPlayer=${bEnableDefenseOtherGuildPlayer}/' PalWorldSettings.ini
          sed -i 's/CoopPlayerMaxNum=[^,)]*/CoopPlayerMaxNum=${CoopPlayerMaxNum}/' PalWorldSettings.ini
          sed -i 's/WorkSpeedRate=[^,)]*/WorkSpeedRate=${WorkSpeedRate}/' PalWorldSettings.ini

          sudo systemctl start pal-server
  WindowsInstanceRunCommand:
    Type: ALIYUN::ECS::RunCommand
    Condition: WindowsOSType
    DependsOn:
      - ReplaceWindowsSystemDisk
      - SleepBeforeRunCommand
    Properties:
      Timeout: 7200
      Type: RunPowerShellScript
      Sync: true
      InstanceIds:
        - Ref: InstanceId
      CommandContent:
        Fn::Sub: |
          $TaskName = "PalServerAutoStart"
          $ProcessName = "PalServer-Win64-Test-Cmd"
          $ProcessName240404 = "PalServer-Win64-Shipping-Cmd"

          if (Get-Process -Name $ProcessName -ErrorAction SilentlyContinue) {
              Stop-Process -Name $ProcessName -Force
              Start-Sleep -Seconds 1
          }
          if (Get-Process -Name $ProcessName240404 -ErrorAction SilentlyContinue) {
              Stop-Process -Name $ProcessName240404 -Force
              Start-Sleep -Seconds 1
          }

          Start-Process "C:\Program Files\PalServer\steam\steamcmd.exe" -ArgumentList "+login anonymous +app_update 2394010 validate +quit" -Wait

          $sourcePath = "C:\Program Files\PalServer\steam\steamapps\common\PalServer\DefaultPalWorldSettings.ini"
          $destPath = "C:\Program Files\PalServer\steam\steamapps\common\PalServer\Pal\Saved\Config\WindowsServer\PalWorldSettings.ini"
          Copy-Item -Path $sourcePath -Destination $destPath -Force

          Set-Location "C:\Program Files\PalServer\steam\steamapps\common\PalServer\Pal\Saved\Config\WindowsServer"
          # Creating a list of settings to replace
          $settingsToReplace = @{
          "Difficulty" = "${Difficulty}"
          "DayTimeSpeedRate" = "${DayTimeSpeedRate}"
          "NightTimeSpeedRate" = "${NightTimeSpeedRate}"
          "ExpRate" = "${ExpRate}"
          "PalCaptureRate" = "${PalCaptureRate}"
          "PalSpawnNumRate" = "${PalSpawnNumRate}"
          "PalDamageRateAttack" = "${PalDamageRateAttack}"
          "PalDamageRateDefense" = "${PalDamageRateDefense}"
          "PlayerDamageRateAttack" = "${PlayerDamageRateAttack}"
          "PlayerDamageRateDefense" = "${PlayerDamageRateDefense}"
          "PlayerStomachDecreaceRate" = "${PlayerStomachDecreaceRate}"
          "PlayerStaminaDecreaceRate" = "${PlayerStaminaDecreaceRate}"
          "PlayerAutoHPRegeneRate" = "${PlayerAutoHPRegeneRate}"
          "PlayerAutoHpRegeneRateInSleep" = "${PlayerAutoHpRegeneRateInSleep}"
          "PalStomachDecreaceRate" = "${PalStomachDecreaceRate}"
          "PalStaminaDecreaceRate" = "${PalStaminaDecreaceRate}"
          "PalAutoHPRegeneRate" = "${PalAutoHPRegeneRate}"
          "PalAutoHpRegeneRateInSleep" = "${PalAutoHpRegeneRateInSleep}"
          "BuildObjectDamageRate" = "${BuildObjectDamageRate}"
          "BuildObjectDeteriorationDamageRate" = "${BuildObjectDeteriorationDamageRate}"
          "CollectionDropRate" = "${CollectionDropRate}"
          "CollectionObjectHpRate" = "${CollectionObjectHpRate}"
          "CollectionObjectRespawnSpeedRate" = "${CollectionObjectRespawnSpeedRate}"
          "EnemyDropItemRate" = "${EnemyDropItemRate}"
          "DeathPenalty" = "${DeathPenalty}"
          "GuildPlayerMaxNum" = "${GuildPlayerMaxNum}"
          "PalEggDefaultHatchingTime" = "${PalEggDefaultHatchingTime}"
          "ServerPlayerMaxNum" = "${ServerPlayerMaxNum}"
          "ServerName" = "`"${ServerName}`""
          "ServerDescription" = "`"${ServerDescription}`""
          "ServerPassword" = "`"${ServerPassword}`""
          "AdminPassword" = "`"${AdminPassword}`""
          "RCONEnabled" = "${RCONEnabled}"
          "bEnablePlayerToPlayerDamage" = "${bEnablePlayerToPlayerDamage}"
          "bEnableFriendlyFire" = "${bEnableFriendlyFire}"
          "bEnableInvaderEnemy" = "${bEnableInvaderEnemy}"
          "bActiveUNKO" = "${bActiveUNKO}"
          "bEnableAimAssistPad" = "${bEnableAimAssistPad}"
          "bEnableAimAssistKeyboard" = "${bEnableAimAssistKeyboard}"
          "DropItemMaxNum" = "${DropItemMaxNum}"
          "DropItemMaxNum_UNKO" = "${DropItemMaxNum_UNKO}"
          "BaseCampMaxNum" = "${BaseCampMaxNum}"
          "BaseCampWorkerMaxNum" = "${BaseCampWorkerMaxNum}"
          "BaseCampMaxNumInGuild" = "${BaseCampMaxNumInGuild}"
          "SupplyDropSpan" = "${SupplyDropSpan}"
          "ItemWeightRate" = "${ItemWeightRate}"
          "DropItemAliveMaxHours" = "${DropItemAliveMaxHours}"
          "bAutoResetGuildNoOnlinePlayers" = "${bAutoResetGuildNoOnlinePlayers}"
          "AutoResetGuildTimeNoOnlinePlayers" = "${AutoResetGuildTimeNoOnlinePlayers}"
          "bIsMultiplay" = "${bIsMultiplay}"
          "bIsPvP" = "${bIsPvP}"
          "bCanPickupOtherGuildDeathPenaltyDrop" = "${bCanPickupOtherGuildDeathPenaltyDrop}"
          "bEnableNonLoginPenalty" = "${bEnableNonLoginPenalty}"
          "bEnableFastTravel" = "${bEnableFastTravel}"
          "bIsStartLocationSelectByMap" = "${bIsStartLocationSelectByMap}"
          "bExistPlayerAfterLogout" = "${bExistPlayerAfterLogout}"
          "bEnableDefenseOtherGuildPlayer" = "${bEnableDefenseOtherGuildPlayer}"
          "CoopPlayerMaxNum" = "${CoopPlayerMaxNum}"
          "WorkSpeedRate" = "${WorkSpeedRate}"
          }

          $fileContent = Get-Content -Path $destPath -Raw

          foreach ($key in $settingsToReplace.Keys) {
          $value = $settingsToReplace[$key]
          $pattern = "$key=[^,)]*"
          $fileContent = $fileContent -replace $pattern, "$key=$value"
          }

          Set-Content -Path $destPath -Value $fileContent

          $TaskName = "PalServerAutoStart"
          Start-ScheduledTask -TaskName $TaskName
Outputs:
  endpoint:
    Label:
      zh-cn: 幻兽帕鲁服务器地址端口
      en: Service Addresses
    Value:
      Fn::Sub:
        - ${ServerAddress}:8211
        - ServerAddress:
            Fn::Select:
              - 0
              - Fn::Jq:
                  - First
                  - .[].PublicIpAddress
                  - 'Fn::GetAtt':
                      - InstanceDataSource
                      - Instances
  document:
    Label:
      zh-cn: 操作说明
      en: Operation Detail
    Value: 登录您的Steam账号后打开幻兽帕鲁游戏并点击开始，输入该服务器地址和端口即可畅快开玩～
Metadata:
  ALIYUN::ROS::Interface:
    Hidden:
      - Difficulty
    ParameterGroups:
      - Parameters:
          - Checkbox
          - InstanceId
          - CreateImage
          - OSType
          - InstancePassword
        Label:
          default:
            zh-cn: 配置游戏服务器
            en: Configure Game Server
      - Parameters:
          - ServerName
          - ServerDescription
          - ServerPassword
          - AdminPassword
          - RCONEnabled
          - ServerPlayerMaxNum
          - GuildPlayerMaxNum
          - Difficulty
          - DeathPenalty
          - DayTimeSpeedRate
          - NightTimeSpeedRate
          - ExpRate
          - PalCaptureRate
          - PalSpawnNumRate
          - PalDamageRateAttack
          - PalDamageRateDefense
          - PlayerDamageRateAttack
          - PlayerDamageRateDefense
          - PlayerStomachDecreaceRate
          - PlayerStaminaDecreaceRate
          - PlayerAutoHPRegeneRate
          - PlayerAutoHpRegeneRateInSleep
          - PalStomachDecreaceRate
          - PalStaminaDecreaceRate
          - PalAutoHPRegeneRate
          - PalAutoHpRegeneRateInSleep
          - BuildObjectDamageRate
          - BuildObjectDeteriorationDamageRate
          - CollectionDropRate
          - CollectionObjectHpRate
          - CollectionObjectRespawnSpeedRate
          - EnemyDropItemRate
          - PalEggDefaultHatchingTime
          - bAutoResetGuildNoOnlinePlayers
          - AutoResetGuildTimeNoOnlinePlayers
          - WorkSpeedRate
          - DropItemMaxNum
          - DropItemMaxNum_UNKO
          - BaseCampMaxNum
          - BaseCampWorkerMaxNum
          - BaseCampMaxNumInGuild
          - SupplyDropSpan
          - ItemWeightRate
          - DropItemAliveMaxHours
          - CoopPlayerMaxNum
          - bEnablePlayerToPlayerDamage
          - bEnableFriendlyFire
          - bEnableInvaderEnemy
          - bActiveUNKO
          - bEnableAimAssistPad
          - bEnableAimAssistKeyboard
          - bIsMultiplay
          - bIsPvP
          - bCanPickupOtherGuildDeathPenaltyDrop
          - bEnableNonLoginPenalty
          - bEnableFastTravel
          - bIsStartLocationSelectByMap
          - bExistPlayerAfterLogout
          - bEnableDefenseOtherGuildPlayer
        Label:
          default:
            zh-cn: 游戏参数配置
            en: Game Parameters
        DefaultExpand: false